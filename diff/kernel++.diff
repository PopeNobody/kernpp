Only in main/: .clang-format
diff '--color=auto' -r main/.git kernel++/.git
1c1
< gitdir: /home/nn/src/git/hub/.git/worktrees/main
---
> gitdir: /home/nn/src/git/hub/.git/worktrees/kernel++
Only in main/: .gitignore
Only in main/: LICENSE
diff '--color=auto' -r main/Makefile kernel++/Makefile
1c1
< MAKEFLAGS:= -rR -j24
---
> MAKEFLAGS:= -rR -j1
4d3
< define dir_infer
6,16c5,17
< $1/src:=  $(wildcard  $1/*.cc)                         
< $1/exe:=  $(patsubst  %.cc,%,   $($1/src))             
< $1/asm:=  $(wildcard  $1/*.S)                          
< $1/xxx:=  $(patsubst  %,%.o,   $($1/asm))             
< $1/exe+=  $(patsubst  %,%,      $($1/asm))             
< $1/obj:=  $(patsubst  %,%.o,   $($1/src))             
< $1/cpp:=  $(patsubst  %,%.ii,   $($1/src))             
< $1/dep:=  $(patsubst  %,%.d,    $($1/obj)   $($1/cpp)  $($1/asm))
< $1:=$($1/exe)
< endef
< $(call dir_infir,bin,lib) 
---
> bin/src:= $(wildcard bin/*.cc)
> bin/exe:= $(patsubst %.cc,%,     $(bin/src))
> bin/obj:= $(patsubst %.cc,%.oo,  $(bin/src))
> bin/cpp:= $(patsubst %.cc,%.ii,  $(bin/src))
> bin/dep:= $(patsubst %,%.d,$(bin/obj))
> bin:=$(bin/exe)
> 
> lib/src:= $(wildcard lib/*.cc)
> lib/lib:= lib/libsimchat.aa
> lib/obj:= $(patsubst %.cc,%.oo,  $(lib/src))
> lib/cpp:= $(patsubst %.cc,%.ii,  $(lib/src))
> lib/dep:= $(patsubst %.cc,%.oo.d,$(lib/src))
> lib:=$(lib/lib)
19d19
< all/xxx:= $(lib/xxx) $(bin/xxx)
23,27c23
< 
< include /dev/null $(wildcard $(all/dep))
< 
< ext/obj:= $(filter-out $(all/obj), $(wildcard *.o))
< ext/xxx:= $(filter-out $(all/xxx), $(wildcard *.o))
---
> ext/obj:= $(filter-out $(all/obj), $(wildcard *.oo))
35d30
< include /dev/null $(wildcard $(all/dep))
37,38c32
< $(lib/lib): $(lib/obj) $(lib/xxx)
< 	sbin/arch "$@" $(lib/obj) $(lib/xxx)
---
> include /dev/null $(wildcard $(all/dep))
40,41c34,35
< $(bin/exe): %: %.o sbin/link etc/ld_flags
< 	sbin/link "$@" $(lib/lib)
---
> $(bin/exe): %: %.oo
> 	sbin/link "$@"	
43,44c37,38
< $(all/cpp): %.ii: %.cc sbin/prec etc/cppflags
< 	rm -f $*.ii $*.o
---
> $(all/cpp): %.ii: %.cc
> 	rm -f $*.ii $*.oo
47,50c41
< $(all/xxx): %.o: %.S sbin/casm etc/asmflags
< 	sbin/casm "$@"
< 
< $(all/obj): %.o: %.ii sbin/comp etc/cxxflags
---
> $(all/obj): %.oo: %.ii
53,55c44,46
< cur/dep:=$(wildcard *.o.d)
< cur/obj:=$(wildcard *.o) $(patsubst %.d,%,$(cur/dep))
< cur/src:=$(patsubst %.o,%.cc,$(cur/obj))
---
> cur/dep:=$(wildcard *.oo.d)
> cur/obj:=$(wildcard *.oo) $(patsubst %.d,%,$(cur/dep))
> cur/src:=$(patsubst %.oo,%.cc,$(cur/obj))
61a53,55
> $(lib/lib): $(lib/obj)
> 	sbin/arch "$@" $(lib/obj)
> 
65,66c59,60
< clean:
< 	rm -f */*.[ioad]
---
> clean: sbin/clean
> 	sbin/clean $(wildcard */*.oo */*.aa */**.d bin/*.exe)
68,71c62,65
< $(all/obj): sbin/comp
< $(bin/exe): sbin/link
< $(lib/lib): sbin/arch
< $(bin/exe): $(lib)
---
> $(eval $(all/obj): sbin/comp)
> $(eval $(bin/exe): sbin/link )
> $(eval $(lib/lib): sbin/arch )
> $(eval $(bin/exe): $(lib) )
73,74d66
< tags: */*.cc */*.hh
< 	ctags --language-force=c++ */*.cc */*.hh
76,77c68,69
< nm:
< 	nm */*.a */*.o --defined-only -A --demangle
---
> ###   
> ###   
Only in main/: README.md
Only in main/bin: .gitignore
Only in main/bin: cat.cc
Only in main/bin: echo.cc
Only in main/bin: ls.cc
Only in main/bin: lspath.cc
Only in main/bin: not.cc
Only in main/bin: report.cc
Only in main/bin: string_view.cc
Only in main/bin: test_getopt.cc
diff '--color=auto' -r main/bin/true.S kernel++/bin/true.S
6c6
<    movq $0,%rdi
---
>    movq $1,%rdi
Only in main/bin: usleep.cc
Only in main/: breakpoints
Only in main/: depends.pl
Only in main/: doc
Only in main/: etc
Only in main/: files.md5
Only in kernel++/inc: addr.hh
Only in main/inc: buf.hh
Only in main/inc: c_str.hh
Only in kernel++/inc: calls.hh
Only in main/inc: char_traits.hh
Only in main/inc: cxxabi.hh
Only in main/inc: dbg.hh
Only in kernel++/inc: debug.hh
Only in main/inc: errno.hh
Only in main/inc: fmt.hh
Only in main/inc: getopt.hh
Only in kernel++/inc: hand.hh
Only in main/inc: new.hh
Only in main/inc: ostream.hh
Only in main/inc: reverse_iterator.hh
Only in kernel++/inc: sim.hh
Only in main/inc: stdlib.hh
Only in main/inc: string_view.hh
Only in main/inc: syscall.hh
Only in main/inc: tinfo.hh
Only in main/inc: typeinfo.hh
Only in main/inc: types.hh
Only in main/inc: write_buf.hh
Only in main/lib: abi.cc
Only in main/lib: c_str.cc
Only in main/lib: cxxabi.cc
Only in main/lib: dbg.cc
Only in main/lib: delete.cc
Only in main/lib: dyncast.cc
Only in main/lib: errno.cc
Only in main/lib: getopt.cc
Only in main/lib: init_array.cc
Only in main/lib: mm.cc
Only in main/lib: new.cc
diff '--color=auto' -r main/lib/start.S kernel++/lib/start.S
1,5c1,2
< #ifdef __ELF__
< .section .note.GNU-stack,""
< #endif
< 	.text
< 	.global _start
---
> .text
> .global _start
7,15c4,11
<   xorl %ebp,%ebp
< 	call libc_init
<   movq 0(%rsp),%rdi
<   lea 8(%rsp),%rsi
<   lea 16(%rsp),%rdx
<   call main
< 	movq %rax,%rdi
< 	call exit
< 	int3
---
> xorl %ebp,%ebp
> call libc_init
> movq 0(%rsp),%rdi
> lea 8(%rsp),%rsi
> call main
> movq %rax,%rdi
> call exit
> int3
Only in main/lib: stdlib.cc
Only in main/lib: strerror_list.cc
Only in main/lib: type_info.cc
Only in main/lib: unistd.cc
Only in main/lib: write_buf.cc
Only in main/sbin: genheaders.pl
Only in main/sbin: genlist.pl
Only in main/sbin: genstrerror.pl
Only in main/sbin: gensyscall.pl
Only in main/sbin: syscall.pl
Only in main/: script
Only in main/: test.pl
